chapter 1 - SpringBean çš„å­¦ä¹ 

Spring Bean å°±æ˜¯æˆ‘ä»¬æ²¡æœ‰å­¦ä¹ æ¡†æ¶ä¹‹å‰ æˆ‘ä»¬è¯´çš„é‚£ä¸ª â€œå¯¹è±¡â€
Spring å½“ä¸­å°±æŠŠ å¯¹è±¡ å«åš Spring Beanï¼Œç®€ç§° Bean

æŠŠå¯¹è±¡å…¨éƒ¨äº¤ç»™ Spring IOC å®¹å™¨å»ç®¡ç†

Bean ä¼šæœ‰ ä½œç”¨åŸŸ å’Œ ç”Ÿå‘½å‘¨æœŸï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å­¦ä¹ å…³äº bean éœ€è¦æŒæ¡çš„ä¸œè¥¿ï¼Œå°¤å…¶éœ€è¦é‡ç‚¹å…³æ³¨ bean çš„ç”Ÿå‘½å‘¨æœŸï¼ï¼



chapter 2 - ç®¡ç† ç¬¬ä¸‰æ–¹ Beanï¼ˆDruidï¼‰

ä¹‹å‰æ˜¯ï¼š
å¦‚æœéœ€è¦ spring IOC å»ç®¡ç†è¿™ä¸ª beanï¼Œå°±åœ¨é…ç½®æ–‡ä»¶ä¸­å» é…ç½®/è£…é… è¿™ä¸ª bean 
è¿™æ˜¯è‡ªå·±åˆ›å»ºçš„ class

é‚£ä¹ˆå¦‚æœæ˜¯æƒ³åˆ›å»ºç¬¬ä¸‰æ–¹ package ä¸­çš„ class çš„ bean æ€ä¹ˆåŠå‘¢ï¼Ÿï¼ˆå¦‚ä½•ç®¡ç†ç¬¬ä¸‰æ–¹ beanï¼Ÿï¼‰

è¿™é‡Œä»¥ é˜¿é‡Œçš„ Druid ä¸ºä¾‹ ï¼ˆDruid æ˜¯ä¸€ä¸ª æ•°æ®åº“è¿æ¥æ± ï¼‰

å…ˆé€šè¿‡ maven æŠŠ Durid çš„ jaråŒ… å¼•å…¥,  com.alibaba:druid:1.2.15

<bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">           ï¼ˆå¯¹äº æ•°æ®åº“è¿æ¥æ± ï¼Œid æˆ‘ä»¬é€šå¸¸å–æˆ dataSourceï¼‰
    <property name="driverClassName" value=""/>                         (driverClassName å°±æ˜¯ jdbcè¿æ¥é©±åŠ¨)
    <property name="url" value=""/>
    <property name="username" value="root"/>
    <property name="password" value="root"/>
</bean>
è¿™é‡Œå°±åˆ›å»ºäº†ä¸€ä¸ª bean å¯¹è±¡ï¼Œå¹¶äº¤ç»™äº† spring IOC å»ç®¡ç† 


ä½†æ˜¯ dbçš„ username å’Œ password é€šå¸¸ä¸ä¼šåƒä¸Šé¢ğŸ‘†é‚£æ · hard code åœ¨ config file é‡Œ
é€šå¸¸æ˜¯åœ¨ resources folder ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª
db.properties

db.driverClassName=com.mysql.jdbc.Driver         ï¼ˆéœ€è¦ç”¨ maven æŠŠè¿™ä¸ª mysql çš„ driver ç»™å¼•å…¥è¿›æ¥ï¼‰
db.url=jdbc:mysql://localhost:3306/mydb          ï¼ˆmysql çš„ç«¯å£é€šå¸¸æ˜¯ 3306ï¼‰
db.username=root
db.password=root 


åŠ è½½å¤–éƒ¨çš„ properties æ–‡ä»¶ï¼Œè§ä¸‹é¢ï¼š

<context:property-placeholder location="classpath:db.properties"/>              è¿™ä¸€è¡Œä¼šå¯¼è‡´å¼•å…¥è¿™ä¸ªæ ‡ç­¾ğŸ·ï¸ï¼š xmlns:context="http://www.springframework.org/schema/context"
                                                                    è¿™é‡Œçš„ location æ˜¯éœ€è¦æ‰¾åˆ° è¿™ä¸ªproperties fileï¼Œresources è¿™ä¸ªfolder çš„è·¯å¾„å°±è¢«ç§°ä¸º classpath
<bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource">
    <property name="driverClassName" value="${db.driverClassName}"/>            è¿™æ˜¯è¿™é‡Œå°±å¯ä»¥ä» properties file é‡Œè¾¹å–å€¼äº†
    <property name="url" value="${db.url}"/>
    <property name="username" value="${db.username}"/>
    <property name="password" value="${db.password}"/>
</bean>



chapter 3 - å·¥å‚ Bean ä¹‹ FactoryBean

æœ¬èŠ‚è¯¾è®²ï¼šSpring çš„ä¸¤ç§ bean

spring ä¸­çš„ bean å¯¹è±¡å…¶å®åˆ†ä¸ºä¸¤ç§ï¼š
1. æ™®é€šçš„ bean ï¼š å®Œå…¨äº¤ç»™äº† IOC å»ç®¡ç†ï¼Œæ™®é€šçš„ bean æ˜¯ç”± IOCå®¹å™¨ åˆ›å»ºçš„ï¼ˆç»å¤§å¤šæ•°bean éƒ½æ˜¯æ™®é€š beanï¼Œå®Œå…¨äº¤ç”±IOCå»ç®¡ç†ï¼Œä½†æ˜¯æœ‰ä¸€äº›ä¾‹å¤–ï¼Œæœ‰äº› beanæˆ‘ä»¬ä¸æƒ³äº¤ç”±IOCç®¡ç†ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ§åˆ¶æƒèƒ½å›åˆ°æˆ‘ä»¬è‡ªå·±æ‰‹ä¸­ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ˜¯æœ‰å·¥å‚ beanï¼‰
2. å·¥å‚ bean ï¼š æƒ³æŠŠæ§åˆ¶æƒå›åˆ°è‡ªå·±æ‰‹ä¸­ï¼Œä¸æƒ³äº¤ç»™ IOCå®¹å™¨ å»ç»Ÿä¸€ç®¡ç†ï¼Œç¨‹åºå‘˜å¸Œæœ›å‚ä¸åˆ° bean å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹å½“ä¸­

æœ‰çš„æ—¶å€™ï¼Œä¸æƒ³æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½äº¤ç»™ IOC å»ç®¡ç† 
ç¨‹åºå‘˜æƒ³å‚ä¸åˆ° bean å¯¹è±¡çš„åˆ›å»ºå½“ä¸­  -->  ä½¿ç”¨å·¥å‚ bean å°±å¯ä»¥å®ç°è¿™ä¸ªï¼Œå«åš FactoryBean

éœ€è¦ç»§æ‰¿ FactoryBean è¿™ä¸ªæ¥å£

public class MyFactory implements FactoryBean {
    
    @Override
    public Object getObject() throws Exception {
        Cat cat = new Cat();
        // æ­¤å¤„çœç•¥å¾ˆå¤šè¡Œå¯¹ cat æ“ä½œçš„ä»£ç  ....
        return cat;
    }

    @Override 
    public Class<?> getObjectType() {
        return Cat.class;           // è¿”å›åˆ›å»ºçš„å¯¹è±¡çš„ class
    }

    @Override
    public boolean isSignleton() {
        return FactoryBean.super.isSingleton();
    }
}

<bean id="myfactory" class="com.ithuangqing.factory.MyFactory"/>

applicationContext.getBean("myfactory", Cat.class);         // æ³¨æ„âš ï¸ï¼šè¿™é‡Œæ˜¯ Cat.class, ä¸æ˜¯ MyFactory.class !!!!

ä»¥ä¸Šå±•ç¤ºçš„å°±æ˜¯ é€šè¿‡ å·¥å‚bean æ¥åˆ›å»º bean

FactoryBean ç”¨å¾—ä¸å¤šï¼ˆä½†ä¹Ÿæ˜¯æœ‰ä¸ªçŸ¥è¯†ç‚¹ï¼‰ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å°±ç”¨æ™®é€š Bean



chapter 4 - Beanå¯¹è±¡ çš„ scopeå±æ€§

å•ä¾‹ - åªåˆ›å»ºä¸€ä¸ªï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™å»è·å–å®ƒï¼Œå§‹ç»ˆè·å–çš„éƒ½æ˜¯é‚£ä¸€ä¸ª


<bean id="cat" class="com.ithuangqing.bean.Cat" p:name="påç§°å‘½åç©ºé—´æ³¨å…¥"/>

Cat cat = applicationContext.getBean("cat", Cat.Bean);
Cat cat1 = applicationContext.getBean("cat", Cat.Bean);
System.out.println(cat == cat1);       // true
è¿™è¯´æ˜ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒIOCå®¹å™¨ç»™æˆ‘ä»¬åˆ›å»ºçš„å¯¹è±¡æ˜¯å•ä¾‹çš„  ->  æ— è®ºè°ƒç”¨å¤šå°‘æ¬¡ getBeanï¼Œå§‹ç»ˆè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡


è¾“å…¥scopeå±æ€§åï¼ŒIDEä¼šæç¤º scopeå±æ€§ æœ‰ä¸¤ç§å€¼ï¼š
prototype    -->  å°±æ˜¯å¤šä¾‹
singleton    -->  å°±æ˜¯å•ä¾‹
é»˜è®¤å€¼å°±æ˜¯ å•ä¾‹


å½“ä½ å‘ä¸‹é¢ğŸ‘‡ä¸€æ ·å†™äº† scope="singleton" ä¹‹å

<bean scope="singleton" id="cat" class="com.ithuangqing.bean.Cat" p:name="påç§°å‘½åç©ºé—´æ³¨å…¥"/>

ä¼šæç¤ºï¼šAttribute scope with default value 'singleton' is superfluous,
ä¼šè®©ä½  Remove "scope" attribute 
å› ä¸º é»˜è®¤å€¼å°±æ˜¯ singleton 


æ”¹æˆ å¤šä¾‹ çš„ï¼š
<bean scope="prototype" id="cat" class="com.ithuangqing.bean.Cat" p:name="påç§°å‘½åç©ºé—´æ³¨å…¥"/>

Cat cat = applicationContext.getBean("cat", Cat.Bean);
Cat cat1 = applicationContext.getBean("cat", Cat.Bean);
System.out.println(cat == cat1);       // false


å¯¹äº å•ä¾‹ï¼Œåœ¨ IOCå®¹å™¨ è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œ
ApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");
å°±å·²ç»æŠŠ Cat å¯¹è±¡åˆ›å»ºå‡ºæ¥äº†

ä½†å¦‚æœæ˜¯ å¤šä¾‹ çš„ï¼Œå°±ä¸ä¼šåœ¨å®¹å™¨è¢«åˆ›å»ºæ—¶ å°±å®ä¾‹åŒ–å¯¹è±¡ï¼Œè€Œæ˜¯ â€œåœ¨æ¯æ¬¡è°ƒç”¨ getBean çš„æ—¶å€™ï¼Œå°±åˆ›å»ºä¸€ä¸ªå¯¹è±¡â€



chapter 5 - Beançš„4ä¸ªä½œç”¨åŸŸ

ä¸ŠèŠ‚è¯¾ï¼šé€šè¿‡ç»™ bean æ·»åŠ  scope å±æ€§ï¼Œç»™å®ƒåˆ’åˆ†æ˜¯å•ä¾‹ è¿˜æ˜¯ å¤šä¾‹

å…³äº ä½œç”¨åŸŸï¼ˆscopeï¼‰æœ‰4ä¸ªå€¼ï¼š
1. singletonï¼ˆé»˜è®¤ï¼‰ï¼š ä»£è¡¨å•ä¾‹ï¼Œåªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œåˆ›å»ºå®¹å™¨çš„æ—¶å€™åˆ›å»º
2. prototypeï¼šå¤šä¾‹ï¼Œåœ¨å®¹å™¨ä¸­æœ‰å¤šä¸ªå¯¹è±¡ï¼Œè°ƒç”¨ getBean çš„æ—¶å€™åˆ›å»º ï¼ˆæ¯è°ƒç”¨ä¸€æ¬¡ getBeanï¼Œå®ƒå°±ç»™ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„å€¼ï¼‰
3. requestï¼š è¯·æ±‚åŸŸ    å½“å‰è¯·æ±‚æœ‰æ•ˆï¼Œç¦»å¼€è¯·æ±‚åŸŸæ— æ•ˆï¼Œï¼ˆé‚£ä¹ˆå¦‚ä½•åˆ¤æ–­æ˜¯ä¸æ˜¯å½“å‰çš„è¯·æ±‚åŸŸå‘¢ï¼Ÿï¼‰URLä¸å˜å³ä¸ºå½“å‰è¯·æ±‚åŸŸ   ï¼ˆç½‘å€ urlé“¾æ¥ ä¸å˜ï¼Œå°±æ˜¯å½“å‰è¯·æ±‚åŸŸï¼›ç½‘å€é“¾æ¥å˜äº†ï¼Œå°±ä¸å†æ˜¯å½“å‰è¯·æ±‚åŸŸï¼‰
4. sessionï¼š ä¼šè¯åŸŸ    å½“å‰ä¼šè¯æœ‰æ•ˆï¼Œç¦»å¼€æ— æ•ˆï¼Œå½“å‰æµè§ˆå™¨ä¸å…³é—­ä¸æ›´æ¢å³ä¸ºå½“å‰ä¼šè¯ï¼ˆåªè¦å½“å‰æµè§ˆå™¨ä¸å…³é—­ä¸æ›´æ¢ï¼Œå°±æ˜¯å½“å‰ä¼šè¯ï¼‰



chapter 6 - åˆè¯† bean çš„ç”Ÿå‘½å‘¨æœŸ 

ç†Ÿæ‚‰ beançš„ç”Ÿå‘½å‘¨æœŸ å¯èƒ½ä¼šè§‰å¾—æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºæƒ³è¦æŠŠ bean çš„ç”Ÿå‘½å‘¨æœŸæçš„ç‰¹åˆ«æ¸…æ¥šï¼Œå°±æ¶‰åŠåˆ° spring çš„åº•å±‚æºç 

ç”Ÿå‘½å‘¨æœŸï¼šå°±æ˜¯ ä»bean çš„ä¸€å¼€å§‹ï¼Œåˆ°ç»“æŸï¼Œéƒ½ç»å†äº†é‚£äº›ä¸œè¥¿

bean çš„ç”Ÿå‘½å‘¨æœŸï¼ˆ4ä¸ªé˜¶æ®µï¼‰ï¼š
1. å®ä¾‹åŒ–ï¼ˆé€šè¿‡ new æŠŠbeanå¯¹è±¡ç»™åˆ›å»ºå‡ºæ¥ï¼‰
2. ä¸º beanè¿›è¡Œ å±æ€§æ³¨å…¥
3. åˆå§‹åŒ– beanï¼ˆå¯¹ bean è¿›è¡Œåˆå§‹åŒ–ï¼‰   --> åˆå§‹åŒ– bean åï¼Œbean å°±å¯ä»¥ç”¨äº†
4. é”€æ¯ bean    -->   åœ¨å®¹å™¨å…³é—­çš„æ—¶å€™æ‰ä¼šé”€æ¯ bean 



chapter 7 - ä»£ç æ¼”ç¤º Bean çš„ ç”Ÿå‘½å‘¨æœŸ 

1. å®ä¾‹åŒ–ï¼ˆå®ä¾‹åŒ–æˆ‘ä»¬çš„ beanï¼‰
2. å±æ€§æ³¨å…¥
3. åˆå§‹åŒ– bean  --> ä¹‹åï¼Œbeanå°±å¯ä»¥ä½¿ç”¨äº†
4. å®¹å™¨å…³é—­ï¼Œbeanè¢«é”€æ¯

æœ¬èŠ‚è¯¾ï¼šé€šè¿‡ä»£ç ï¼Œå¯¹è¿™4ä¸ªéƒ¨åˆ†æœ€ä¸€ä¸ªæ¼”ç¤º


